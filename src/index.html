<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Ionic App</title>

  <base href="/" />

  <meta name="color-scheme" content="light dark" />
  <meta name="viewport"
    content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />

  <link rel="icon" type="image/png" href="assets/icon/favicon.png" />

  <!-- add to homescreen for ios -->
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
</head>

<body>
  <app-root></app-root>
  <script>
    const items = [
      { name: 'Latte', price: 3.5 },
      { name: 'Cappuccino', price: 4.0 },
      { name: 'Espresso', price: 2.5 },
      { name: 'Tea', price: 2.0 },
      { name: 'Americano', price: 3.0 },
      { name: 'Mocha', price: 4.25 },
      { name: 'Macchiato', price: 3.75 },
      { name: 'Hot Chocolate', price: 3.5 }
    ];
    const cart = [];

    function renderItems() {
      const itemListContainer = document.getElementById('existing-items');
      itemListContainer.innerHTML = ''; // Clear existing items
      items.forEach((item, index) => {
        const el = document.createElement('li');
        el.innerHTML = `
          ${item.name} - $${item.price.toFixed(2)} 
          <button onclick="editItem(${index})">Edit</button>
          <button onclick="deleteItem(${index})">Delete</button>
        `;
        itemListContainer.appendChild(el);
      });
    }

    function addItem(event) {
      event.preventDefault();  // Prevent the form from submitting traditionally

      const name = document.getElementById('item-name').value;
      const price = parseFloat(document.getElementById('item-price').value);

      if (name && !isNaN(price)) {
        // Add new item to the items array
        items.push({ name, price });

        // Re-render the item list and the product list
        renderItems();
        renderProductList();

        // Reset the form after adding the item
        document.getElementById('item-form').reset();
      } else {
        alert("Please provide valid item details.");
      }
    }

    function editItem(index) {
      const item = items[index];
      document.getElementById('item-name').value = item.name;
      document.getElementById('item-price').value = item.price;

      // Remove the item after editing, so it can be added back as updated
      deleteItem(index);
    }

    function deleteItem(index) {
      items.splice(index, 1);  // Remove item from the array
      renderItems();  // Re-render the item list in the management section
      renderProductList();  // Re-render the product list
    }

    function renderProductList() {
      const productListContainer = document.getElementById('product-list');
      productListContainer.innerHTML = ''; // Clear existing products
      items.forEach(item => {
        const el = document.createElement('div');
        el.className = 'product';
        el.innerHTML = `
          <h4>${item.name}</h4>
          <p>$${item.price.toFixed(2)}</p>
          <button onclick="addToCart('${item.name}', ${item.price})">Add</button>
        `;
        productListContainer.appendChild(el);
      });
    }

    function addToCart(name, price) {
      cart.push({ name, price });
      renderCart();
    }

    function renderCart() {
      const cartItemsContainer = document.getElementById('cart-items');
      const totalDisplay = document.getElementById('total');
      cartItemsContainer.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        total += item.price;
        const el = document.createElement('div');
        el.className = 'cart-item';
        el.innerHTML = `<span>${item.name}</span><span>$${item.price.toFixed(2)}</span>`;
        cartItemsContainer.appendChild(el);
      });
      totalDisplay.innerText = `Total: $${total.toFixed(2)}`;
    }

    function checkout() {
      const receipt = document.getElementById('receipt');
      const receiptItemsContainer = document.getElementById('receipt-items');
      const receiptTotalDisplay = document.getElementById('receipt-total');
      const dateTimeDisplay = document.getElementById('date-time');

      receiptItemsContainer.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        total += item.price;
        const el = document.createElement('div');
        el.className = 'receipt-item';
        el.innerHTML = `<span>${item.name}</span><span>$${item.price.toFixed(2)}</span>`;
        receiptItemsContainer.appendChild(el);
      });
      receiptTotalDisplay.innerText = `Total: $${total.toFixed(2)}`;

      const now = new Date();
      const formattedDateTime = now.toLocaleString();
      dateTimeDisplay.innerText = formattedDateTime;

      document.getElementById('cart').style.display = 'none';
      receipt.style.display = 'block';

      cart.length = 0;
    }

    function updateReceiptWidth(value) {
      const receiptContent = document.getElementById('receipt-content');
      receiptContent.className = value === '50' ? 'receipt-50mm' : 'receipt-80mm';
    }

    function filterProducts() {
      const query = document.getElementById('search').value.toLowerCase();
      const products = document.querySelectorAll('.product');
      products.forEach(product => {
        const name = product.querySelector('h4').textContent.toLowerCase();
        product.style.display = name.includes(query) ? 'block' : 'none';
      });
    }

    function showProducts() {
      document.getElementById('product-section').style.display = 'block';
      document.getElementById('manage-items-section').style.display = 'none';
    }

    function showManageItems() {
      document.getElementById('product-section').style.display = 'none';
      document.getElementById('manage-items-section').style.display = 'block';
    }

    // document.getElementById('item-form').addEventListener('submit', addItem);

    // Initial render
    renderItems();
    renderProductList();
    showProducts(); // Default view is the products section
  </script>
</body>

</html>